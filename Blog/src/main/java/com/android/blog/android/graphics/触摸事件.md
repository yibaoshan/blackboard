
- 触摸事件的起源（Linux）
  - 触摸屏驱动捕获原始事件
    - 信号触发，介绍触摸屏原理
    - 信号转换，模拟信号转为数字信号
  - 驱动上报原始事件
    - Linux input 子系统介绍
    - 驱动与 Linux kernel 建立通信连接
    - 建立成功后，驱动上报原始事件
    - Linux 内核处理/解析事件
- 三，触摸事件的传递（Android）
  - 现在触摸数据已经保存在 xxx 节点了，接下来的任务就是读取节点，再封装成不同的事件类型，屏幕坐标，分发给APP
  - native 层
  - java 层
    - APP事件的分发顺序
    - viewrootimpl
      - 这个类在之前的几篇文章中反复出现， activitythread 作为 ams 和 app 之间的沟通的桥梁，viewrootimpl 就是 wms 和 app 的中央枢纽，和 view 相关的发/收消息基本上都在这个类
      - 那么问题就来了，事件肯定是先到达 view 的，但我们都知道，在实际的开发过程中，activity 往往最先得到事件，并且还可以拦截掉，不继续向下分发给视图，这是为什么？
- 四，触摸事件的消费（Application）
  - activity 拦截与消费
    - 每一层都可以消费，并且，可以选择是否要拦截
  - viewgroup 拦截与消费
  - view 拦截与消费
  - 当发生事件冲突时，我们只需要一层层剥开固定的几个方法，非常简单
- 五，结语
  - 总结一下从按下屏幕后，事件是怎么传递到我们的应用的
  - 按下屏幕后，事件是怎么传递到我们的应用的？
  - 首先，触摸屏驱动捕获事件，转交给内核
  - 最后，一次完整的 Android 触摸事件的分发流程，大致是这样的
- 六，参考资料


### QA

- 触控MCU和触控IC的区别是什么？
  - 触控IC可以理解为IC只负责输出高或低电平的信号，再给后面的 主MCU做采集处理。
  - 触控MCU是指MCU内置了touch单元，相当于SOC，无需外挂触控IC，设计，验证参数整体性能时，可以通过调试工具的GUI，直观监测参数调整后的效果。
  - 而触控IC，则为独立的touch芯片，通常是通过串行接口(例如，I2C、SPI)与主控MCU之间进行通讯实现数据交换，用户需要开发相应的通讯程序，都增加了软件开发的负荷。


### 触摸事件的起源（Linux）

在[《当我们点击“微信”应用后，它是怎么显示出来的？》](https://mp.weixin.qq.com/s/JeGPyknzc0G_TCQNHZD3AQ)这篇文章中，为了了解什么是 GPU / DPU 模块，我们拆了一台小米11手机

今天，我们继续来拆小米，不过这次拆的是小米10（因为没找到米11和米12的屏幕拆解图。。）

如图

小米10屏幕的触控IC使用的是，来自意法半导体"FJABH"触控芯片方案，这块芯片是用来干嘛的呢？

用来和 CPU 进行通信的

我们都知道，我们写的代码是跑在 CPU 上的，

今天是为了了解触控 IC

文章的开头，我们需要了解触摸事件是怎么从硬件驱动传递到内核的，这需要 触控 IC 来帮助理解



新思 触控 ic S3200

这里我们不讨论触摸屏的工作原理

矢量压力传感式、电阻式、电容式、红外线式和表面声波式

我们平时使用的手机几乎都是电容触摸屏，电容触摸屏的工作原理分为：

单个电容

你有没有想过，电容屏的工作原理是怎样的？

我们现在

操作系统来判定，当前是

- [电阻屏已经被智能手机抛弃，还有哪些应用场景？](https://rohm.eefocus.com/article/id-317)
- [手机全贴合屏幕技术解析](https://blog.csdn.net/weixin_51554164/article/details/124965131)