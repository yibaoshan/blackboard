
数字电路学习笔记（基于我的世界红石系统）

以下内容来自知乎作者 JoshCena 的博客：https://www.zhihu.com/people/joshcena/posts

### 一、什么是数字电路？

我们从一道经典的初中物理题开始：

> 某档案室有三把钥匙，分别由主任与两个保管员保管
> 主任的钥匙可以直接开门，而两个保管员的钥匙则只有同时插入才能开门
> 档案室大门还有一个防盗装置，激活时无论什么钥匙都无法开门
> 以上，试着画出电路图


电路图：https://pic1.zhimg.com/80/v2-8b6ce552d182e7b076503545b084ef5a_1440w.webp?source=d16d100b

这道题目本身并没什么难度，但它的背后却暗含了数字电路的思想

我们把所有可能的情况列出来以后：https://picx1.zhimg.com/v2-613223898aaa3a8912b90d1bffdd5191_720w.jpg?source=d16d100b

会发现它就是所谓的“真值表”，其实，它还可以被化为更加抽象的函数形式，这里写不下就不写了

### 二、数制与编码

数制，指的是2/10/16进制，暂时不用学

编码，简单地说，就是把信息从一种形式转为另一种，比如：

- 学号是对学生的编码
- 车牌号是对汽车的编码
- 编程时程序语言转为机器码也是编码

在计算机中，编码的含义是，如何把实际生活中形形色色的信息编码为二进制数

比如数字，或者，字符，这需要一种规则

#### 十进制数的编码

过程：略

结论：有三种最重要的数字编码方案：二进制码，计算优势较大；BCD码，计算效率与直观性的妥协；格雷码，适用于计数

负数，小数，的表示规范，原码、反码、补码

#### 字符的编码

ASCII码，把常用字符都用二进制表达，使用了一个字节中的七个bit，最高位留空

其后字符编码的需求愈发扩大，尤其是计算机在亚洲国家逐渐普及，于是Unicode应运而生

它有17个编码集合；每个集合从0000至FFFF共65536个位置可编码。其中ASCII码也是Unicode的一个子集。


### 三、逻辑/布尔运算

先来了解几个概念

**逻辑运算**，又叫布尔运算，是通过一系列既定的逻辑规则，对一些逻辑命题进行恒等变形的研究

**真值表**，它描述了对于所有可能的自变量取值，因变量的值的情况。它的存在是建立在布尔运算中变量的可能值很少，可以穷举的前提上的

**逻辑图**，用示意图的形式表示逻辑运算关系，是抽象化的电路，直观化的算式

#### 基本逻辑：非

众所周知，运算可以分成一元、二元与多元

其中一元运算只有一个：非逻辑 (NOT)

- **非**：只有当 A 不发生时，X才发生，观察真值表，可以知道非逻辑本质上是将变量进行了取反

#### 基本逻辑：或

或逻辑 (OR) 是最基础的两个二元逻辑之一

- **或**：只要当 A 或 B 中有一个发生时，X 就发生，A、B、X 同样可以组成真值表

举例，A = 0 ，B = 1 ，则 X = 1；

A = 1 ，B = 0 ，则 X = 1；

#### 基本逻辑：与

与逻辑 (AND) 是另一个基本二元逻辑

- **与**：有当 A 与 B 都发生时，X才发生

模拟下 "与" 的真值表：

A = 0 ，B = 0 ，X = 0

A = 1 ，B = 0 ，X = 0

A = 0 ，B = 1 ，X = 0

A = 1 ，B = 1 ，X = 1

#### 基本逻辑：异或

异或 (XOR) 是较为特殊的二元逻辑

- **异或**：只有当 A 或 B 中有一个发生时，X才发生（注意和或逻辑的”只有“”只要“的区别！）

真值表如下：

A = 0 ，B = 0 ，X = 0

A = 1 ，B = 0 ，X = 1

A = 0 ，B = 1 ，X = 1

A = 1 ，B = 1 ，X = 0

只有当 A 或 B 等于1时，X 才为1，都等于或都不等于1，X 不为1

#### 基本逻辑：同或

同或 (XNOR) 是另一种特殊的二元逻辑。

- **同或**：只有当 A 与 B 都发生或都不发生时，X 才发生

和楼上的异或，定义和真值表都相反

#### 复合逻辑

除了以上五种逻辑，还有几种也成为了值得关注的逻辑，它们统称为复合逻辑，比如：与非 (NAND) (AB)′(AB)'(AB)' 、或非 (NOR) (A+B)′(A+B)'(A+B)'

以及多元运算与或非 (A+BC)′(A+BC)'(A+BC)'

以上逻辑的使用场景有什么呢？我们再次回到档案室的问题，主任、两个保管员、防盗装置可以表示为：

```
{
    主任的钥匙插入 or
    {
        保管员A的钥匙插入 and 保管员B的钥匙插入
    }
} and (not 防盗系统开启)
    门锁开启
```

### 四、逻辑/布尔代数

香农的《继电器和开关电路的符号化分析》

不管由开关组成的电路有多复杂，布尔代数一样可以很好地对其进行解释

逻辑代数系统由，基本公式、常用公式、基本规则三部分构成

#### 基本公式

正如四则预算中，加减乘除存在各式运算律一样，逻辑/布尔运算中的与或非，也有运算规律

在布尔运算中，运算优先级是 非 > 与 > 或

（1）交换律、结合律、分配律

（2）还原律

（3）重叠律

（4）互补律

（5）德·摩根定律

以上，1、2、3、4、5，略，mark 不学

#### 常用公式

（1）吸收公式

（2）消因子公式

（3）并项公式

（4）消项公式

同以上，略

#### 基本规则

（1）代入规则

（2）反演规则

（3）对偶规则

含义，略

### 五、逻辑/布尔设计

之前花了两章，探讨了逻辑/布尔运算是什么，怎么算

但还有最后一个大问题，巧妇难为无米之炊，我们得先有一个逻辑式，才能对它化简

最后，基于结果做电路设计

所以，如何把实际生活中的问题转化为逻辑函数式呢？

先介绍两种比较标准的函数的形式：

- 最小项表达式，若干单项式相加
- 最大项表达式，若干多项式相乘

实际中用得比较多的是最小项表达式

#### 从真值表得出函数式

假设我们有这样一个真值表：

A = 0 ，B = 0 ，C = 0 ，D = 0 ，X = 0

A = 0 ，B = 0 ，C = 0 ，D = 1 ，X = 0

A = 0 ，B = 0 ，C = 1 ，D = 0 ，X = 0

A = 0 ，B = 1 ，C = 0 ，D = 0 ，X = 0

A = 0 ，B = 1 ，C = 0 ，D = 1 ，X = 1

A = 1 ，B = 1 ，C = 1 ，D = 1 ，X = 1

如何方便地写出它的表达式？

先试试把它转述为自然语言后照着写：“只要A，B，C，D分别为0000，或者0101，或者0110，或者......时，X就为1”。这样，的确可以写出方程

那么，能不能直接通过真值表写出函数式呢？

可以，比如楼上的可以分别写出它们对应的乘积项，即A'B和AB'；最后把它们连在一起：AB'+A'B，即可

#### 从函数式得出真值表

结论可以，过程看不懂，后面还有卡诺图啥的，也不看了

### 六、组合逻辑电路

组合逻辑，就是之前讲过的黑箱逻辑

![img](https://pic2.zhimg.com/80/v2-a505937cb4c6b3c92622a58c8ba9a94d_720w.webp)

组合电路设计的关键之处，就在于找出这个函数关系

还是以档案室来举例：

> 某档案室有三把钥匙，分别由主任与两个保管员保管。主任的钥匙可以直接开门，而两个保管员的钥匙则只有同时插入才能开门。档案室大门还有一个防盗装置，激活时无论什么钥匙都无法开门。

这是文字表述的任务要求；在第三节中，我们写出了逻辑式，画出逻辑图：

![img](https://pic1.zhimg.com/80/v2-d4ed68252dc88982f802b6831ea04db0_720w.webp)

在实际生产中，只要有了这个图，设计实际的集成电路就简单了，只要把对应的符号换成门电路元件即可

### 七、经典组合逻辑器件

![数字电路学习笔记（七）：经典组合逻辑器件（上）](https://picx1.zhimg.com/v2-57277831bcd780bd69cc641734890434_720w.png?source=d16d100b)

本章来用几种常见的组合逻辑电路，来做一个计算器，实现加法和减法

#### 编码器

编码器能够将单一的输入信号编码。比如，计算机键盘按下一个键，就会被编码成一个八位的ASCII码

实现部分忽略

这样，我们完成了计算器的第一部分：把按钮输入对应成一个能够计算的二进制数

#### 译码器

与编码器相对，译码器把一个二进制码译回单一的输出

在本项目的最后，也需要将计算出的数字译回0~9，方便由屏幕的驱动器再做计算

实现略过

#### 数据分配器

略

#### 数据选择器

略

### 八、计算电路

#### 半加器

略

#### 多位加法器（全加器）

《穿越计算机的迷雾》，有详细介绍

#### 减法器

略

#### 比较器

#### 算术逻辑单元（ALU）

算术逻辑单元 (Arithmetic Logic Unit) 是计算机中实现数值和逻辑的基础元件

它不是实现某一特定功能的元件，而是许多功能的集合

在前文中实现了所有需要的元件之后，我们可以尝试做出一个1比特ALU。它能执行的指令包括：

```cpp
ADD    X1,  X2,  X3     //加法
SUB    X1,  X2,  X3     //减法
AND    X1,  X2,  X3     //按位与
ORR    X1,  X2,  X3     //按位或
```

注意，每一个指令都要接受两个参数

### 九、初识锁存器

所有的组合逻辑电路都能实现计算功能，但是

计算机不能只会计算，还需要能够存储数据，我们应该如何用逻辑门来实现存储数据的功能呢？

#### RS锁存器

先来定义，我们将能够存储一个状态的电路叫做**锁存器**

设想一个电路，初始输入为0，输出为0

然后输入为1，输出变为1（状态发生了变化）

对于迄今为止所有的电路，我们都能保证，当输入回到0时，输出也会同时归0

但这个电路不同，它保持在了1，也就是状态没有发生变化，而是被存储了下来

此时，这种电路便可以被叫做锁存器

##### 1、或非门锁存器

看不懂

##### 2、与非门锁存器

同样看不懂

### 十、更多锁存器和触发器

本章是基于 RS 锁存器设计出更加适合存储数据的存储电路

#### 门控RS锁存器

看不懂

#### D锁存器

看不懂

#### RS触发器

一个只在某个时刻发生状态更新的锁存器就叫做**触发器**

#### JK触发器

略

#### D触发器

略

#### T触发器

略

### 十一、时序逻辑

我们从一个例子开始，说明时序逻辑的概念和作用

> **设计一个电路，当连续输入四个及以上的高电平时，输出高电平；其他时候，输出低电平**

时序电路和组合逻辑电路类似，我们来分析一下：

它的**输入**（命名为 X ）和**输出**（命名为 Y ），同时

用两位来存储输入的高电平的数量： Q1 Q0 。当 Q1 Q0=11 时

每次输入一个高电平，即认为已经“连续输入了四个以上的高电平”，输出高电平

否则，任何一次输入，根据输入决定是状态+1还是状态归 0，看图

![img](https://pica.zhimg.com/80/v2-0dfec6c3976b0c6eef768125e985955b_720w.webp?source=d16d100b)

解释一下，在图中4个节点的任意位置表示当前的状态

- **如果输入的是高电平，状态向前进一**

- **如果输入的是低电平，状态归零**

#### 电路分析

过程忽略，结果如下图

![img](https://picx1.zhimg.com/80/v2-ee6646a8afedb1ac896ddaac3d4c66a3_720w.webp?source=d16d100b)

时序逻辑电路，是在组合逻辑电路的基础上，增加一个存储电路

### 十二、时序逻辑设计

一般来说，如果已经给出需求，时序逻辑设计有如下几步：

1. 把自然语言描述的逻辑抽象化，确定电路状态数，画出状态转换图；
2. 确定使用的触发器，列出三个方程：输出方程、驱动方程、状态方程；
3. 设计具体电路。

现在，我们直接从具体案例分析：

> 设计一个自动售饮料机的逻辑电路。它的投币口每次只能投入一枚五角或一元的硬币。累计投入一元五角硬币后机器自动给一杯饮料；投入二元硬币后，在给饮料的同时退回一枚五角的硬币

接下来，我们要定义变量与状态、画出状态转换图与状态编码、列出方程，最后画出电路图

当然，这个过程我是略过的，看原文